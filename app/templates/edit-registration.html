{% extends 'base.html' %}
{% import "bootstrap/wtf.html" as wtf %}

{% block head %}
	<link type="text/css" rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	{{ super() }}
{% endblock %}

{% block app_content %}



	{% if event.stage == 1 %}
	<div class="row">
		<div class="col-md-4">
			{{ wtf.quick_form(form) }}
		</div>
	</div>
	{% endif %}

	<hr>

	{% if event.stage != 1 %}
		<a class="btn btn-primary padded" href="{{ url_for('openRegistration', event_id=event.id) }}" role="button">Open Registration</a>
		<a class="btn btn-danger disabled padded" role="button" aria-disabled="true">Close Registration</a>
		{% if event.stage == 2 %}
			<a class="btn btn-success padded confirmation" role="button" href="{{ url_for('createPools', event_id=event.id) }}">Create Pools</a>
			<script type="text/javascript">
				var allCheckedIn = {% if allCheckedIn %}true{% else %}false{% endif %}

			    $('.confirmation').on('click', function () {
					//if(!allcheckedIn) {
						return confirm('Make sure all fencers present are checked in before creating pools.');
					//}
			    });
			</script>
		{% else %}
			<a class="btn btn-success disabled padded" role="button" aria-disabled="true">Create Pools</a>
		{% endif %}
	{% else %}
		<a class="btn btn-primary disabled padded" role="button" aria-disabled="true">Open Registration</a>
		<a class="btn btn-danger padded" href="{{ url_for('closeRegistration', event_id=event.id) }}" role="button">Close Registration</a>
		<a class="btn btn-success disabled padded" role="button" aria-disabled="true">Create Pools</a>
	{% endif %}

	<hr>

	<table class="table table-striped">
		<thead>
		<tr>
			<th width="220px">Status</th>
			<th>Last Name</th>
			<th>First Name</th>
			<th>Club</th>
			<th>Team</th>
			<th>Rating</th>
		</tr>
		</thead>
		{% for fencer in fencers %}
		<tr>
			<td>
				{% if fencer.isCheckedIn %}
					<a class="btn btn-success btn-sm disabled padded" role="button" aria-disabled="true">&#10004;</a>
					<a class="btn btn-danger btn-sm padded" role="button" href="{{ url_for('makeAbsent', event_id=event.id, fencer_id=fencer.id) }}">&#128683;</a>
					<span style="color: green;">Checked In</span>
				{% else %}
					<a class="btn btn-success btn-sm padded" role="button" href="{{ url_for('checkInFencer', event_id=event.id, fencer_id=fencer.id) }}">&#10004;</a>
					<a class="btn btn-danger btn-sm disabled padded" role="button" aria-disabled="true">&#128683;</a>
					<span style="color: red;">Absent</span>
				{% endif %}
			</td>
			<td>{{ fencer.lastName }}</td>
			<td>{{ fencer.firstName }}</td>
			<td></td>
			<td>{{ fencer.team.name }}</td>
			<td>{{ fencer.ratingClass }}{{ fencer.ratingYear }}</td>
		{% endfor %}
	</table>
{% endblock %}
